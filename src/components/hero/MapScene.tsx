"use client";

import { useEffect, useState } from "react";
import MapPin from "@/components/hero/MapPin";
import styles from "@/components/hero/MapScene.module.css";

type Region = {
  id: string;
  name: string;
  path: string;
};

type PinInfo = {
  label: string;
  value: string;
};

type PinData = {
  id: string;
  label: string;
  title: string;
  subtitle: string;
  x: number;
  y: number;
  regionId: string;
  info: PinInfo[];
};

const REGION_DATA: Region[] = [
  {
    id: "halton",
    name: "Halton",
    path: "M 173.6875 432.875 L 160 406.875 L 153.4375 411.25 L 126.34375 362.28125 L 135.09375 359.21875 L 93.71875 277.375 L 14.625 327.96875 L 16.21875 331.53125 L 8.6875 336.28125 L 5.9375 333.53125 L 0.78125 337.0625 L 71.96875 470.34375 C 72.196276 474.29865 72.167368 474.63003 68.8125 475.46875 C 66.254976 476.10813 63.97539 475.5123 61.6875 476.65625 C 59.806819 477.59658 57.658396 477.38707 55.375 477.84375 C 53.479341 478.22289 52.468864 480.09352 51.8125 481.40625 C 50.871719 483.2878 50.21875 482.96341 50.21875 486.15625 C 50.218751 488.03864 52.805516 490.38652 53.78125 491.6875 C 55.60329 494.11687 56.928734 494.46437 59.3125 495.65625 C 60.974122 496.48705 63.716545 494.44587 65.25 494.0625 C 67.332744 493.54182 69.276055 493.07161 71.5625 492.5 C 73.652172 491.97757 76.50664 492.5 78.6875 492.5 C 81.787552 492.49999 84.789742 492.2145 87.40625 490.90625 C 89.677714 489.77051 91.318153 489.19036 93.71875 487.75 C 95.196944 486.8631 97.327789 486.52361 98.875 485.75 C 100.68728 484.84385 102.16672 483.55988 104.40625 483 C 106.5142 482.47302 108.51043 480.55729 109.9375 479.84375 C 112.03711 478.79394 112.69054 477.6555 115.0625 477.0625 C 117.59979 476.42819 119.3501 474.32495 121 473.5 C 122.58929 472.70536 123.40637 471.12494 124.96875 470.34375 C 127.08658 469.28483 127.92864 466.6763 130.09375 465.59375 C 132.27092 464.50516 133.83687 463.55031 135.25 462.84375 C 137.24962 461.84394 138.01335 459.2679 139.1875 458.09375 C 140.57157 456.70969 141.81993 454.31301 143.15625 452.53125 C 144.37713 450.90341 147.20959 449.73895 148.6875 449 C 150.72764 447.97993 152.35784 446.11373 154.21875 444.625 C 156.18831 443.04935 158.36539 442.47836 160.15625 440.6875 C 161.66079 439.18296 163.28467 438.34034 164.90625 436.71875 C 165.86349 435.76154 169.22769 435.15178 170.84375 434.34375 C 171.93632 433.79747 172.8167 433.35469 173.6875 432.875 z",
  },
  {
    id: "peel",
    name: "Peel",
    path: "M 215.5 397.0625 C 215.00316 394.89611 215.19661 392.44269 214.65625 390.28125 C 214.43417 389.39294 213.56883 388.37074 212.75 387.375 C 212.34058 386.87713 211.91818 386.37639 211.625 385.90625 C 211.33182 385.43611 211.15625 384.99976 211.15625 384.59375 C 211.15625 383.73959 211.07437 382.34494 211.25 381.09375 C 211.33781 380.46815 211.48798 379.8711 211.75 379.40625 C 212.01202 378.9414 212.38315 378.59952 212.90625 378.46875 C 213.81858 378.24067 214.66391 377.98316 215.34375 377.46875 C 215.68367 377.21154 215.96404 376.87459 216.21875 376.46875 C 216.47346 376.06291 216.69229 375.57458 216.84375 374.96875 C 216.92297 374.6519 217.24492 373.32606 217.28125 372.09375 C 217.29941 371.47759 217.25987 370.87982 217.0625 370.4375 C 216.86513 369.99518 216.51819 369.71875 215.96875 369.71875 C 215.13725 369.71875 213.33122 369.99465 211.8125 369.90625 C 211.05314 369.86205 210.35841 369.73223 209.90625 369.4375 C 209.68017 369.29013 209.49565 369.0823 209.40625 368.84375 C 209.31685 368.6052 209.31906 368.31752 209.40625 367.96875 C 209.59234 367.22439 209.68948 366.58629 209.6875 366 C 209.68552 365.41371 209.59156 364.87417 209.40625 364.375 C 209.03563 363.37666 208.29432 362.48183 207.21875 361.40625 C 206.26537 360.45287 205.46818 359.65651 205.25 358.84375 C 205.14091 358.43737 205.16806 358.03427 205.40625 357.59375 C 205.64444 357.15323 206.08678 356.6771 206.78125 356.15625 C 207.41198 355.6832 208.47207 354.91018 209.4375 354.09375 C 210.40293 353.27732 211.27726 352.44548 211.59375 351.8125 C 211.90195 351.19609 212.25448 350.24131 212.46875 349.15625 C 212.68302 348.07119 212.7597 346.8513 212.46875 345.6875 C 212.32302 345.1046 212.17698 344.52039 212.03125 343.9375 L 196.03125 176.59375 L 81.84375 174.5625 L 82.25 179.28125 L 75.53125 184.84375 L 73.5625 182.46875 L 52.59375 195.125 L 93.53125 277.03125 L 93.71875 277.375 L 135.09375 359.21875 L 126.34375 362.28125 L 153.4375 411.25 L 160 406.875 L 173.6875 432.875 C 174.98436 432.16061 176.14475 431.41775 177.15625 430.40625 C 177.54055 430.02194 178.22275 430.13181 178.75 430 C 180.60355 428.14643 181.75506 425.61657 182.6875 424.0625 C 184.04178 421.80538 185.74778 420.94635 186.25 418.9375 C 186.77236 416.84804 187.07265 415.85105 188.625 413.78125 C 190.02301 411.91724 192.66595 409.77398 194.15625 408.65625 C 196.69658 406.751 199.01578 405.24211 201.6875 403.90625 C 204.2669 402.61655 205.72049 401.74869 207.59375 400.34375 C 209.33496 399.03782 211.40389 400.53361 213.15625 398.78125 C 213.88552 398.05197 214.67944 397.53802 215.5 397.0625 z",
  },
  {
    id: "toronto",
    name: "Toronto",
    path: "M 393.46875 340.96875 L 383.40625 327.3125 L 382.96875 306.34375 C 382.13572 306.34375 224.75957 306.34376 208.4375 306.34375 L 212.03125 343.9375 C 212.17698 344.52039 212.32302 345.1046 212.46875 345.6875 C 212.7597 346.8513 212.68302 348.07119 212.46875 349.15625 C 212.25448 350.24131 211.90195 351.19609 211.59375 351.8125 C 211.27726 352.44548 210.40293 353.27732 209.4375 354.09375 C 208.47207 354.91018 207.41198 355.6832 206.78125 356.15625 C 206.08678 356.6771 205.64444 357.15323 205.40625 357.59375 C 205.16806 358.03427 205.14091 358.43737 205.25 358.84375 C 205.46818 359.65651 206.26537 360.45287 207.21875 361.40625 C 208.29432 362.48183 209.03563 363.37666 209.40625 364.375 C 209.59156 364.87417 209.68552 365.41371 209.6875 366 C 209.68948 366.58629 209.59234 367.22439 209.40625 367.96875 C 209.31906 368.31752 209.31685 368.6052 209.40625 368.84375 C 209.49565 369.0823 209.68017 369.29013 209.90625 369.4375 C 210.35841 369.73223 211.05314 369.86205 211.8125 369.90625 C 213.33122 369.99465 215.13725 369.71875 215.96875 369.71875 C 216.51819 369.71875 216.86513 369.99518 217.0625 370.4375 C 217.25987 370.87982 217.29941 371.47759 217.28125 372.09375 C 217.24492 373.32606 216.92297 374.6519 216.84375 374.96875 C 216.69229 375.57458 216.47346 376.06291 216.21875 376.46875 C 215.96404 376.87459 215.68367 377.21154 215.34375 377.46875 C 214.66391 377.98316 213.81858 378.24067 212.90625 378.46875 C 212.38315 378.59952 212.01202 378.9414 211.75 379.40625 C 211.48798 379.8711 211.33781 380.46815 211.25 381.09375 C 211.07437 382.34494 211.15625 383.73959 211.15625 384.59375 C 211.15625 384.99976 211.33182 385.43611 211.625 385.90625 C 211.91818 386.37639 212.34058 386.87713 212.75 387.375 C 213.56883 388.37074 214.43417 389.39294 214.65625 390.28125 C 215.19661 392.44269 215.00316 394.89611 215.5 397.0625 C 216.58523 396.4336 217.73856 395.92473 219.0625 395.59375 C 221.82956 394.90197 224.99542 394.96342 227.78125 394.40625 C 230.49425 393.86364 233.68729 391.1564 235.6875 389.65625 C 238.25453 387.73096 239.35868 386.39132 241.625 384.125 C 243.00992 382.74005 246.39231 381.76529 248.34375 381.375 C 252.41533 380.56069 252.30351 379.68076 255.0625 381.75 C 257.59855 383.65204 257.72232 383.71183 261 384.53125 C 264.21154 385.33413 265.61987 386.33022 268.5 386.90625 C 269.89834 387.18593 269.3125 391.75436 269.3125 392.84375 C 269.3125 396.3293 270.03572 396.75447 272.0625 398.78125 C 273.38016 400.09891 275.48858 399.9375 277.59375 399.9375 C 279.69284 399.93751 281.67678 397.86741 283.125 396.78125 C 283.65225 396.38581 284.19149 395.98919 284.71875 395.59375 C 287.71729 393.34483 289.03938 391.87093 291.84375 390.46875 C 292.5894 390.09591 293.42786 389.91988 294.21875 389.65625 C 295.12914 389.35278 296.04605 389.13863 296.96875 388.875 C 297.49132 388.72568 298.03524 388.63181 298.5625 388.5 C 302.38111 387.54535 302.06465 387.74785 304.5 385.3125 C 306.88674 382.92578 309.67112 382.9375 312.78125 382.9375 C 319.68494 382.93749 315.75939 382.41022 317.15625 382.15625 C 319.39903 382.15626 321.32806 379.14069 322.28125 378.1875 C 323.80922 376.65952 325.92353 375.78963 327.8125 374.65625 C 329.73552 373.50242 331.32048 372.65625 333.75 372.65625 C 335.3275 372.65625 338.32705 370.58648 339.6875 369.90625 C 341.571 368.96449 342.60515 366.44594 343.25 365.15625 C 344.06295 363.53031 346.25939 362.87031 348 362 C 351.19095 360.40452 356.38636 359.91023 359.84375 359.21875 C 362.13078 358.76133 364.69592 357.19892 366.96875 356.0625 C 367.49601 355.79887 368.03524 355.54488 368.5625 355.28125 C 372.01141 353.55681 374.66491 353.96226 377.65625 351.71875 C 379.65457 350.22002 382.56207 348.8596 384.78125 347.75 C 386.79803 346.74161 389.68404 344.40972 391.09375 343 C 391.76208 342.33167 392.60487 341.63037 393.46875 340.96875 z",
  },
  {
    id: "york",
    name: "York",
    path: "M 382.53125 306.34375 L 382.09375 116.59375 L 448.96875 116.59375 L 447.5625 65.46875 C 446.20343 66.189087 444.55441 68.013876 443.28125 68.96875 C 441.1304 70.581889 439.22064 72.343277 436.96875 72.90625 C 434.11592 73.619452 432.9017 74.858239 429.84375 74.09375 C 428.1891 73.680086 426.74121 71.482427 426.28125 70.5625 C 425.54648 69.09299 426.28125 65.065924 426.28125 63.4375 C 426.28124 61.824157 421.19776 66.14599 421.15625 66.1875 C 419.73178 67.611994 419.53245 70.186307 418 71.71875 C 416.92604 72.79271 413.27877 72.53125 411.65625 72.53125 C 408.28606 72.53125 408.18339 71.02714 406.53125 69.375 C 405.03297 69.874424 405.98238 68.826129 405.71875 68.5625 C 404.35283 67.196595 399.15502 67 397.03125 67 C 394.86267 67.000003 392.89775 68.944124 390.3125 69.375 C 388.15237 69.735015 386.82649 67.337214 386.34375 65.40625 C 386.06407 64.287478 383.64721 62.086968 382.78125 61.4375 C 381.46691 60.451748 378.21826 63.618847 377.25 63.8125 C 375.03992 64.254515 374.27573 63.325365 372.125 62.25 C 369.33584 60.85542 368.06278 63.077985 365.78125 64.21875 C 363.84279 65.18798 361.9681 65.8125 359.46875 65.8125 C 356.67696 65.812503 355.75444 64.09486 353.125 63.4375 C 350.45803 62.770757 347.73923 65.130381 345.625 66.1875 C 343.38064 67.309682 341.82879 68.476229 339.28125 69.75 C 336.91924 70.931001 335.35029 72.52798 332.96875 73.71875 C 331.55686 74.424695 332.1875 78.051262 332.1875 79.65625 C 332.1875 82.519237 331.20434 83.528835 330.1875 85.5625 C 329.7018 86.5339 332.77574 88.150736 333.375 88.75 C 334.73573 90.11074 335.47444 90.491498 336.125 93.09375 C 336.67935 95.311149 336.65237 97.703021 336.125 99.8125 C 335.60882 101.8772 334.32002 103.45371 333.375 105.34375 C 332.29801 107.49771 330.99083 108.1164 329.8125 109.6875 C 328.68781 111.18711 328.53716 112.39696 326.625 112.875 C 324.14837 113.49416 323.44648 113.24115 322.28125 111.6875 C 320.85677 109.7882 320.91994 108.96101 320.3125 106.53125 C 319.74729 104.27039 316.34375 104.3755 316.34375 106.9375 C 316.34375 109.27033 315.1861 111.22579 314.78125 113.25 C 314.73313 113.49065 312.8933 115.47561 312.78125 115.625 C 312.2788 118.13721 311.35259 120.18337 310.8125 122.34375 C 310.46016 123.75309 308.45837 126.02425 307.65625 127.09375 C 307.27629 127.60035 303.13602 128.43474 302.125 128.6875 C 300.29508 129.14497 297.75984 132.27314 297.375 133.8125 C 296.819 136.03647 296.53724 137.02526 295.40625 138.15625 C 294.55291 139.00959 294.29447 142.34856 293.8125 143.3125 C 292.6655 145.60652 291.52893 146.97803 291.0625 148.84375 C 290.54195 150.92595 289.62485 151.46889 288.28125 152.8125 C 286.94994 154.1438 287.09375 155.168 287.09375 157.53125 C 287.09374 158.2153 282.5357 161.05135 281.9375 161.5 C 280.13606 162.85109 278.30172 163.92522 276.40625 165.0625 C 274.14774 166.4176 271.73219 166.92633 269.6875 167.4375 C 267.27909 168.03961 264.88107 169 262.1875 169 C 259.52216 169 260.26811 170.74006 259.8125 172.5625 C 259.32778 174.50137 258.55148 175.2762 256.65625 175.75 C 254.63703 176.25481 253.00761 176.53125 250.71875 176.53125 C 248.39222 176.53125 248.26019 178.5 245.5625 178.5 C 243.87573 178.5 242.41982 176.91982 241.625 176.125 C 240.08479 174.5848 240.14866 176.88471 238.4375 177.3125 C 237.56366 177.53095 236.21504 177.3125 235.28125 177.3125 L 196.03125 176.59375 L 208.4375 306.34375 C 224.71866 306.34376 380.91932 306.34375 382.53125 306.34375 z",
  },
  {
    id: "durham",
    name: "Durham",
    path: "M 488.09375 1.6875 C 486.79711 2.250502 485.04017 4.2723284 484.8125 4.5 C 483.05362 6.2588797 481.96857 7.8598133 481.25 9.65625 C 480.60136 11.277824 478.92632 12.741113 478.09375 14.40625 C 477.1931 16.207559 475.86023 17.340361 475.3125 19.53125 C 474.77757 21.670949 475.0062 23.16267 474.53125 25.0625 C 473.97435 27.290132 473.33831 27.830174 472.15625 29.40625 C 471.00346 30.94329 470.62637 32.091015 469.78125 33.78125 C 468.62504 36.09368 466.72319 37.928627 465.4375 40.5 C 464.49527 42.384455 463.6407 43.281109 462.65625 45.25 C 461.83004 46.902443 460.48484 48.968135 459.125 50.78125 C 457.49177 52.95889 456.70522 54.808326 455.5625 57.09375 C 454.61835 58.982039 453.37296 60.064542 452 61.4375 C 450.53909 62.898425 449.68879 64.389976 447.65625 65.40625 C 447.62853 65.420109 447.59048 65.453921 447.5625 65.46875 L 448.96875 116.59375 L 382.09375 116.59375 L 382.53125 306.34375 C 382.5353 306.34375 382.96666 306.34375 382.96875 306.34375 L 383.40625 327.3125 L 393.46875 340.96875 C 394.79932 339.9497 396.25786 339.04491 397.8125 338.65625 C 400.39537 338.01052 403.07532 337.875 406.125 337.875 C 408.60334 337.87499 409.61759 339.40069 411.25 340.625 C 412.44967 341.52476 415.26056 341.03125 416.8125 341.03125 C 419.27075 341.03126 421.17721 340.44274 423.53125 341.03125 C 426.1509 341.68617 428.43507 342.625 431.8125 342.625 C 435.21646 342.62499 438.23933 342.34589 440.90625 341.8125 C 443.98539 341.19666 445.63938 339.85218 448.03125 338.65625 C 450.85726 337.24324 451.24855 336.28125 454.75 336.28125 C 457.72705 336.28125 459.27542 336.81885 461.875 337.46875 C 464.97888 338.24471 466.2831 337.32952 468.59375 339.0625 C 470.52659 340.51214 473.12426 339.766 474.53125 339.0625 C 476.096 338.28014 479.28425 338.66482 480.875 339.0625 C 483.22525 339.65008 483.66147 341.93881 486.40625 342.625 C 488.72165 343.20385 490.78166 343.67958 493.5 343 C 494.02727 342.86817 494.5665 342.75682 495.09375 342.625 C 497.77815 341.95389 500.04915 341.03125 503 341.03125 C 506.22495 341.03126 505.39367 339.86242 506.96875 341.4375 C 509.78636 341.4375 513.10317 344.09846 515.65625 345.375 C 517.93147 346.5126 520.35355 347.75 523.1875 347.75 C 525.1821 347.74999 528.48426 348.44525 530.28125 349.34375 C 532.36116 350.38369 535.54112 349.96341 537.8125 350.53125 C 540.64546 351.2395 544.12635 351.22623 546.90625 350.53125 C 549.69792 349.83335 552.19213 348.79815 554.8125 347.75 C 556.36544 347.12881 558.44589 347.03696 560.34375 346.5625 C 562.68188 345.97797 564.30012 347.35628 565.875 347.75 C 568.12104 348.31149 570.05532 348.53125 572.59375 348.53125 C 574.96641 348.53124 577.34608 348.53125 579.71875 348.53125 C 582.36628 348.53124 583.06035 349.21767 584.875 350.125 C 586.87375 351.12439 589.0237 352.3653 591.1875 352.90625 C 593.29748 353.43374 595.33186 355.1064 597.53125 355.65625 C 599.90347 356.24931 601.30971 356.84375 603.84375 356.84375 C 606.2164 356.84375 608.59608 356.84375 610.96875 356.84375 C 613.6798 356.84375 616.39802 357.44671 618.875 358.4375 C 620.87637 359.23803 623.50369 359.47748 625.59375 360 C 627.32777 360.43353 628.86569 360.8125 631.125 360.8125 C 633.79568 360.81251 635.20209 361.12864 637.0625 361.59375 C 638.45434 361.94172 640.36027 361.59375 641.8125 361.59375 L 639.4375 262.34375 L 573.78125 261.9375 L 574.1875 179.53125 C 572.7459 180.54687 568.48148 181.93114 566.65625 182.84375 C 565.24103 183.55138 563.62065 185.50435 562.3125 186.8125 C 560.50185 188.62314 557.91692 189.71857 556 191.15625 C 554.555 192.24003 552.92504 192.93118 552.03125 194.71875 C 551.55987 195.6615 548.30704 197.17461 546.90625 197.875 C 545.51889 198.5687 542.75825 199.15213 541.375 199.84375 C 538.75721 201.15263 536.49733 200.66693 535.8125 203.40625 C 535.273 205.56411 534.20553 206.41287 532.28125 207.375 C 529.92524 208.55301 529.74194 209.50806 528.3125 210.9375 C 526.60356 212.64646 526.14677 213.9555 523.96875 214.5 C 522.13694 214.95794 520.044 216.3912 517.625 216.875 C 513.48757 217.70249 513.83611 216.82604 516.4375 214.875 C 518.76602 213.12862 520.2194 211.49934 521.59375 210.125 C 523.1556 208.56314 523.72075 207.54538 525.53125 206.1875 C 526.94947 205.12387 527.72143 201.57975 528.71875 200.25 C 530.04871 198.47673 530.0754 195.56795 531.09375 193.53125 C 532.05739 191.60397 531.74726 189.35472 532.28125 187.21875 C 532.80268 185.133 533.84375 183.35084 533.84375 180.875 C 533.84373 178.32819 535.03125 176.59224 535.03125 174.15625 C 535.03122 171.40317 535.58241 170.59375 532.65625 170.59375 C 530.28407 170.59375 529.03665 172.70795 528.3125 174.15625 C 527.73685 175.30759 525.6992 176.76955 524.75 177.71875 C 522.9981 179.47063 522.44069 180.80931 521.1875 182.0625 C 519.90236 183.34765 518.76817 185.33866 518.03125 186.8125 C 517.18941 188.49619 516.4375 189.11003 516.4375 191.5625 C 516.43752 193.14541 514.42122 195.95378 513.6875 196.6875 C 512.11214 198.26284 510.91357 200.62566 509.71875 202.21875 C 508.09145 204.38849 505.67064 205.62748 504.59375 207.78125 C 503.37613 210.21647 503.33808 211.78691 501.4375 213.6875 C 499.95183 215.17315 497.8439 214.26569 496.6875 213.6875 C 495.26329 212.97538 495.875 209.37187 495.875 207.78125 C 495.87499 205.16222 496.9259 204.7964 497.46875 202.625 C 497.99918 200.50335 499.53243 198.95675 500.625 197.5 C 501.65823 196.12236 503.14251 195.03812 504.59375 194.3125 C 504.86065 194.17905 506.04759 188.99857 506.15625 188.78125 C 506.82104 187.45167 509.16742 186.12053 510.125 184.84375 C 510.447 184.41443 510.125 182.25083 510.125 181.65625 L 508.53125 5.3125 C 510.06615 3.2659741 503.12203 3.594492 502.625 3.71875 C 500.92465 4.143834 498.91124 5.5221908 498.25 5.6875 C 497.66961 5.8326004 495.25905 3.3125 493.5 3.3125 C 491.18906 3.3124999 490.87527 3.4690245 489.15625 1.75 C 488.89957 1.4933212 488.52596 1.4998327 488.09375 1.6875 z",
  },
];

const PIN_DATA: PinData[] = [
  {
    id: "toronto",
    label: "Toronto",
    title: "King West Tower",
    subtitle: "Mixed-Use",
    x: 47.5,
    y: 70.5,
    regionId: "toronto",
    info: [
      { label: "City", value: "Toronto" },
      { label: "Type", value: "Mixed-Use" },
      { label: "Units", value: "210" },
      { label: "Services", value: "Cleaning / Security" },
    ],
  },
  {
    id: "mississauga",
    label: "Mississauga",
    title: "Port Credit Residences",
    subtitle: "Residential",
    x: 29.0,
    y: 69.5,
    regionId: "peel",
    info: [
      { label: "City", value: "Mississauga" },
      { label: "Type", value: "Residential" },
      { label: "Units", value: "180" },
      { label: "Services", value: "Cleaning / Concierge" },
    ],
  },
  {
    id: "brampton",
    label: "Brampton",
    title: "Bramalea Heights",
    subtitle: "Residential",
    x: 24.0,
    y: 56.5,
    regionId: "peel",
    info: [
      { label: "City", value: "Brampton" },
      { label: "Type", value: "Residential" },
      { label: "Units", value: "160" },
      { label: "Services", value: "Maintenance / Cleaning" },
    ],
  },
  {
    id: "vaughan",
    label: "Vaughan",
    title: "VMC Plaza",
    subtitle: "Commercial",
    x: 44.0,
    y: 44.5,
    regionId: "york",
    info: [
      { label: "City", value: "Vaughan" },
      { label: "Type", value: "Commercial" },
      { label: "Units", value: "12 Buildings" },
      { label: "Services", value: "Security / Vendor" },
    ],
  },
  {
    id: "markham",
    label: "Markham",
    title: "Unionville Point",
    subtitle: "Mixed-Use",
    x: 57.5,
    y: 42.5,
    regionId: "york",
    info: [
      { label: "City", value: "Markham" },
      { label: "Type", value: "Mixed-Use" },
      { label: "Units", value: "140" },
      { label: "Services", value: "Cleaning / Maintenance" },
    ],
  },
  {
    id: "richmond-hill",
    label: "Richmond Hill",
    title: "Bayview Terraces",
    subtitle: "Residential",
    x: 50.5,
    y: 30.5,
    regionId: "york",
    info: [
      { label: "City", value: "Richmond Hill" },
      { label: "Type", value: "Residential" },
      { label: "Units", value: "120" },
      { label: "Services", value: "Concierge / Cleaning" },
    ],
  },
  {
    id: "oakville",
    label: "Oakville",
    title: "Lakeshore Place",
    subtitle: "Residential",
    x: 24.5,
    y: 82.5,
    regionId: "halton",
    info: [
      { label: "City", value: "Oakville" },
      { label: "Type", value: "Residential" },
      { label: "Units", value: "110" },
      { label: "Services", value: "Cleaning / Security" },
    ],
  },
  {
    id: "burlington",
    label: "Burlington",
    title: "Mapleview Commons",
    subtitle: "Commercial",
    x: 16.5,
    y: 88.5,
    regionId: "halton",
    info: [
      { label: "City", value: "Burlington" },
      { label: "Type", value: "Commercial" },
      { label: "Units", value: "8 Buildings" },
      { label: "Services", value: "Security / Vendor" },
    ],
  },
  {
    id: "milton",
    label: "Milton",
    title: "Derry Industrial Park",
    subtitle: "Industrial",
    x: 20.5,
    y: 72.0,
    regionId: "halton",
    info: [
      { label: "City", value: "Milton" },
      { label: "Type", value: "Industrial" },
      { label: "Units", value: "6 Buildings" },
      { label: "Services", value: "Maintenance / Vendor" },
    ],
  },
  {
    id: "pickering",
    label: "Pickering",
    title: "City Centre Lofts",
    subtitle: "Residential",
    x: 71.5,
    y: 52.0,
    regionId: "durham",
    info: [
      { label: "City", value: "Pickering" },
      { label: "Type", value: "Residential" },
      { label: "Units", value: "130" },
      { label: "Services", value: "Cleaning / Concierge" },
    ],
  },
  {
    id: "ajax",
    label: "Ajax",
    title: "Salem Hub",
    subtitle: "Commercial",
    x: 76.5,
    y: 49.0,
    regionId: "durham",
    info: [
      { label: "City", value: "Ajax" },
      { label: "Type", value: "Commercial" },
      { label: "Units", value: "5 Buildings" },
      { label: "Services", value: "Security / Cleaning" },
    ],
  },
  {
    id: "oshawa",
    label: "Oshawa",
    title: "Downtown Square",
    subtitle: "Mixed-Use",
    x: 81.5,
    y: 46.0,
    regionId: "durham",
    info: [
      { label: "City", value: "Oshawa" },
      { label: "Type", value: "Mixed-Use" },
      { label: "Units", value: "150" },
      { label: "Services", value: "Cleaning / Maintenance" },
    ],
  },
];

export default function MapScene() {
  const [activePinId, setActivePinId] = useState<string | null>(null);
  const [hoveredRegionId, setHoveredRegionId] = useState<string | null>(null);
  const activePin = PIN_DATA.find((pin) => pin.id === activePinId) ?? null;
  const activeRegionId = hoveredRegionId;

  useEffect(() => {
    if (typeof window === "undefined") return;
    const handleKey = (event: KeyboardEvent) => {
      if (event.key === "Escape") {
        setActivePinId(null);
        setHoveredRegionId(null);
      }
    };
    window.addEventListener("keydown", handleKey);
    return () => window.removeEventListener("keydown", handleKey);
  }, []);

  const handlePinClick = (id: string) => {
    setActivePinId((current) => (current === id ? null : id));
  };

  const handleRegionHover = (regionId: string | null) => {
    setHoveredRegionId(regionId);
  };

  return (
    <section className={styles.section}>
      <div className={styles.inner}>
        <div className={styles.statsRow}>
          <div className={styles.statCard}>
            <div className={styles.statIcon} aria-hidden="true">
              <svg viewBox="0 0 24 24">
                <path
                  d="M4 18h16M6 18V8h4v10M14 18V4h4v14"
                  fill="none"
                  stroke="currentColor"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            </div>
            <div className={styles.statNumber}>34</div>
            <div className={styles.statLabel}>Properties Managed</div>
          </div>
          <div className={styles.statCard}>
            <div className={styles.statIcon} aria-hidden="true">
              <svg viewBox="0 0 24 24">
                <path
                  d="M4 7h16M4 12h16M4 17h10"
                  fill="none"
                  stroke="currentColor"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                />
              </svg>
            </div>
            <div className={styles.statNumber}>1.8M sq ft</div>
            <div className={styles.statLabel}>Coverage Area</div>
          </div>
          <div className={styles.statCard}>
            <div className={styles.statIcon} aria-hidden="true">
              <svg viewBox="0 0 24 24">
                <path
                  d="M12 6v6l4 2M12 3a9 9 0 1 0 0 18 9 9 0 0 0 0-18Z"
                  fill="none"
                  stroke="currentColor"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            </div>
            <div className={styles.statNumber}>24/7</div>
            <div className={styles.statLabel}>Response Monitoring</div>
          </div>
          <div className={styles.statCard}>
            <div className={styles.statIcon} aria-hidden="true">
              <svg viewBox="0 0 24 24">
                <path
                  d="M6 12l4 4 8-8"
                  fill="none"
                  stroke="currentColor"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            </div>
            <div className={styles.statNumber}>99%</div>
            <div className={styles.statLabel}>Service Retention</div>
          </div>
        </div>
        <div className={styles.mapWrap}>
          <div
            className={styles.mapStage}
            onMouseLeave={() => handleRegionHover(null)}
          >
            <div className={styles.mapLayer}>
              <svg
                className={styles.mapSvg}
                viewBox="0 0 643 500"
                preserveAspectRatio="xMidYMid meet"
                role="img"
                aria-label="Greater Toronto Area map"
              >
                <g className={styles.regionGroup}>
                  {REGION_DATA.map((region) => {
                    const isActive = activeRegionId === region.id;

                    return (
                      <path
                        key={region.id}
                        d={region.path}
                        className={`${styles.regionShape} ${
                          isActive ? styles.regionActive : ""
                        }`}
                        tabIndex={0}
                        aria-label={`${region.name} region`}
                        role="img"
                        onMouseEnter={() => handleRegionHover(region.id)}
                        onMouseLeave={() => handleRegionHover(null)}
                        onFocus={() => handleRegionHover(region.id)}
                        onBlur={() => handleRegionHover(null)}
                      />
                    );
                  })}
                </g>
              </svg>
              <div className={styles.pinsLayer}>
                {PIN_DATA.map((pin) => (
                  <MapPin
                    key={pin.id}
                    id={pin.id}
                    label={pin.label}
                    x={pin.x}
                    y={pin.y}
                    active={pin.id === activePinId}
                    dimmed={false}
                    onClick={handlePinClick}
                    onHover={() => handleRegionHover(pin.regionId)}
                    onBlur={() => handleRegionHover(null)}
                  />
                ))}
              </div>
            </div>
            {activePin && (
              <div className={styles.mapCard} role="dialog" aria-modal="false">
                <div className={styles.mapCardHeader}>
                  <button
                    type="button"
                    className={styles.mapCardClose}
                    onClick={() => setActivePinId(null)}
                    aria-label="Close"
                  >
                    X
                  </button>
                </div>
                <div className={styles.mapCardBody}>
                  <div className={styles.mapCardTitle}>{activePin.title}</div>
                  <div className={styles.mapCardSubtitle}>{activePin.subtitle}</div>
                  <div className={styles.mapCardInfo}>
                    {activePin.info.map((item) => (
                      <div className={styles.mapCardRow} key={item.label}>
                        <span className={styles.mapCardLabel}>{item.label}</span>
                        <span>{item.value}</span>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            )}
          </div>
        </div>
      </div>
    </section>
  );
}
